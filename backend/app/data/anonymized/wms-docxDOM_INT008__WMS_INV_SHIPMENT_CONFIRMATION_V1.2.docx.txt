**Table:**

| Business / Technical Brief |
| [Anonymized Customer]-INT008 WMS INV Shipment Confirmation 13th Jun 2024, Version  Copyright © 2024, Oracle and/or its affiliates |

---

# Document Control

## Change History

---
**Table:**

| Date | Author | Version | Description |
| 13-Jun-2024 | Harshal Tiwari | 1a | Initial Version |
| 25-Jun-2024 | Amit Sharma | 1b | Updated document with the WMS details |
| 25-Jun-2024 | Pavan Kumar | 1b | Updated document with the Technical Details |
| 24-July-2024 | Girish Karampuri | 1.2 | Updated shipmethod change, Waybill and shipping cost functionaliy |

---

## Reviewed By

---
**Table:**

| Date | reviewer | role |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

# Introduction

## Purpose

The objective of this document is to provide a Design Specification to:
Provide the necessary information with enough detail so that the Project team, have a clear understanding of the design and functional requirements.

## Scope

This document specifies the business context, functional requirements, and details to integrate Oracle Cloud WMS to Oracle Fusion for Sales Order Shipping Process.
A warehouse management system (or WMS) is a software application designed to support warehouse or distribution center management and staff. They facilitate management of available resources to move and store materials into, within, and out of a warehouse, while supporting staff in material movement and storage.
Coordinating the communication with these systems to support purchase order receipts, returns to vendors, internal material transfers, inventory transactions, and sales order shipments is a substantial integration effort.
Inventory Management Cloud supports a central integration framework across Oracle Procurement Cloud, Oracle Order Management Cloud, and Oracle Inventory Management based on web services to support the interactions between WMS and Fusion Cloud.
Using these services, Inventory Management Cloud communicates Sales Order shipment request to Oracle Cloud WMS for processing.

## Functional Overview

[Anonymized Customer] business process flow requires WMS to send the Shipment Confirmation notification to Oracle Fusion on successfully shipping the sales order in WMS. On receiving the request Shipment Lines of the Sales Order in Fusion should get marked as Shipped to complete the fulfillment process in Fusion. This integration will run as in when an order is shipped in WMS.
Sales order or transfer order documents are created in Oracle fusion cloud. Order orchestration steps take the orders to awaiting shipping and then order will be eligible to interface to WMS cloud.
The delivery ID is generated based on the customer ship to name, ship to country, scheduled ship date and the customer party site number. Order will be interfaced to WMS and Delivery Id will be a sent as Externally planned load number on the WMS Order lines.
Orders will be waved for allocation and task creation. Task will be performed and pick pack will be completed. Load will be shipped from WMS Cloud. This will interface the shipping details to Fusion Inventory cloud to ship confirm the delivery.

# Business Objectives

When integrating Oracle Warehouse Management system (or WMS) with Oracle Inventory Management Cloud, there is a requirement to send the Ship Confirmation request of WMS to Fusion Oracle Inventory Management so that Sales Order lines in fusion can be marked as Shipped.
Business Flow:
The above picture depicts the process flow as per business requirement. Fusion sales order is interfaced to WMS and a new Sales Order is created in WMS. This sales order will further get Pick, Pack and Ship in WMS. Once a sales order is shipped, Shipment Confirmation integration will be triggered from WMS to Oracle Fusion to notify the Fusion system that the sales order is shipped. On receiving the Shipment Confirmation request from WMS, Sales Order line status will be changed from Awaiting Shipping to Shipped to mark the end of fulfillment.
The above picture depicts the general steps in the Sales order business flow. The steps initiate in Fusion Order Management with the creation of a Sales Order. This sales order gets interfaced to WMS via OIC integration to create an Outbound Order. WMS allocates the order and ship it. The shipment details are then interfaced back to Fusion to update the shipment information, decrement the inventory quantities in stock and to update the sales order status.

## Process Overview

- The scheduled process Generate Shipment Request enables inventory management users to send shipment lines to the WMS using the task Create Outbound Shipment request using a scheduled process.
- Delivery Id will be created by grouping the order by customer, ship to address and schedule ship date. Order will be interfaced to WMS and Delivery Id will be a sent as External plan load number on the WMS Order lines.
- After the all the lines in the delivery/load is picked and packed and loading operation will be performed using RF transactions.
- Before ship load Waybill no, Shipping charges will be entered on the Obload. In case of the ship method change other than what is there on the sales order, it can be updated by changing ship method on carrier field on Obload screen.
- Load will be shipped from WMS Cloud. The Receive Shipment Confirmation is new web service when initiated with the required input, receives and processes the shipment confirmation messages. This service interprets and transforms the message and creates the necessary records in the shipping open interface tables. This transformation provides the mechanism for the WMS to send the material and shipping details for the shipment lines fulfilled.
- The scheduled process Perform Shipping Transactions processes the pending transaction records received into the open interface tables. The process validates the data on the transaction records received from the WMS before processing them. Any errors from the validation step are recorded, and the transaction records remain in the open interface tables. The interface records with errors are available for users to view, edit, or resolve the errors, or reprocess.
The following is a high-level view of the most relevant information to be considered:
Facility Code (Inventory Organization in SCM Cloud)
Company Code (Business Unit in SCM Cloud)
Order Number
Shipment line number
Item code
Load number (Mapped to Delivery/shipment number)
Packed Quantity
Lock code (Mapped to Sub inventory in SCM Cloud)
Serial Number
Lot Number
Weight
Volume
Freight cost
Carrier
Waybill no

# Pre-Conditions

- Fusion Sales Order should be interfaced to WMS.
- Shipment line should cancel or closed in Fusion.

# Sales order lines in SCM Cloud should be in Awaiting shipping status.

- Sales order in SCM Cloud should not be having any shipping hold on it.
- Sales order should be in Open status.

# Risk Matrix

---
**Table:**

| Risk | Impact  (1 to 5) | Probability (1 to 5) | Mitigation |
| Ship confirmation failure in Fusion cloud due to Order lines in other than awaiting shipping status | 5 | 2 | Rerun the order orchestration and make sure that the order lines in the awaiting shipping status. Retrigger shipment interface from WMS |
| Ship confirmation failure in Fusion cloud due to Order on Hold | 5 | 2 | Remove the hold and Retrigger shipment interface from WMS |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |

---

# Other Integrations Design Dependency

---
**Table:**

| Name | Dependency | comments |
| WMS Items (INT001) |  | Items should be interfaced to WMS from Fusion PDH |
| Sales Order/TO Interface |  | Sales order/TO should be interfaced to WMS from Fusion Inventory |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

# Frequency

---
**Table:**

| Responsiveness | Frequency | Data volume |
|  | Outbound Load Export file gets generated once the Load is shipped in WMS. |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

# Open Items

This section is used to summarize any open items related to the design.

---
**Table:**

| No. | open item | data required | status | impact if not closed |
| 001 |  |  |  |  |
| 002 |  |  |  |  |
| 003 |  |  |  |  |
| 004 |  |  |  |  |
| 005 |  |  |  |  |
| 006 |  |  |  |  |
| 007 |  |  |  |  |

---

# Business Use Case:

- Pick, pack and ship the Load with Single order having single line with single LPN without Serial and lot no.
- Pick, pack and ship the Load with Single order having single line with single LPN with Serial and lot no.
- Pick, pack and ship the Load with Single order having multiple line with single LPN without Serial and lot no.
- Pick, pack and ship the Load with Single order having single line with multiple LPN with Serial and lot no.
- Pick, pack and ship the Load with Multiple order having multiple LPN without Serial and lot no.
- Pick, pack and ship the Load with Multiple order having multiple LPN with Serial and lot no.

# Technical Overview

### Scope

The objective of this document is to provide with a Technical Specification of Inbound Integration Shipment Confirmation flow between Warehouse Management System (WMS) and Oracle Fusion Inventory Management.

### Glossary

---
**Table:**

| Annotation | Definition |
| ERP | Enterprise Resource Planning |
| SCM | Supply Chain Management |
| OIC | Oracle integration cloud |
| WMS | Warehouse Management System |
| REST | Representational State Transfer |
| XSD | XML Schema Definition |
| FYI | For Your Information |

---

### Document References

---
**Table:**

| Ref No | Name | File location |
|  |  |  |
|  |  |  |
|  |  |  |

---

### Sample Data & Mapping Template

---
**Table:**

| Description | File |
| Data Mapping Template for Fusion to WMS |  |
| Sample WMS Response XML Payload |  |

---

### Frequency

---
**Table:**

| Responsiveness | Frequency | Volume |
| Batch | Planned as daily with Ad Hoc option | Depends on the RMA orders created in the last 24 hours by users |

---

### Assumptions

- Inventory organizations of Fusion Inventory should be mapped with WMS Facilities.
- Mapping between WMS Shipment Confirmation Request and ERP Request should be in place for this integration to work effectively.
- In case of any success/error in the integration, a notification email will be sent to the mail list configured in the OIC lookup.

### High Level Approach

- Fetch the Shipment Confirmation related information from WMS.
- Invoke “Shipment Service” request and perform “createAndConfirm” operation then run “Perform Shipping Transactions” ESS job operation to create and confirm the Shipment.
- Fields of Shipment Confirmation Request from WMS System are mapped to Oracle fusion to create and confirm Shipment Transaction in Fusion.

### High Level Flow Diagram

### Pre-Requisites

Send Email Integration ““XxCommonNotificationHandler” should be deployed in the OIC.
Lookup “XX[Anonymized Customer]CommonLookup” should be present with all the required details regarding success/error email notify flag, success and error notify ToEmail Address in OIC.
Lookup “Xx[Anonymized Customer]ConstantLookup” should be present with all the required details regarding success and error notify FromEmail Address in OIC.
Lookup “Xx[Anonymized Customer]WmsSubInvLookup” should be present in OIC.

# Integration Analysis –XxScmShipmentConfirmationWmsToErp

This Integration component is responsible for communicating Shipment Confirmation to Fusion Inventory sent by WMS system.

### Integration Components

Below are the required components for this integration.

---
**Table:**

| Integration Name | Integration Pattern | Package Name | Lookup Name |
| XxScmShipmentConfirmationWmsToErp | App Driven Orchestration |  | XX[Anonymized Customer]CommonLookup, Xx[Anonymized Customer]ConstantLookup, Xx[Anonymized Customer]WmsSubInvLookup |

---

### Required Connections

---
**Table:**

| Connection Name | Connection Type | Connection Role |
| Xx[Anonymized Customer]ErpCloudConnection | Oracle ERP Cloud | Trigger and invoke |
| XxOicRestTrigger | REST | Trigger |
| Xx[Anonymized Customer]ErpCloudSoap | SOAP | Trigger and invoke |

---

### Integration Outline

The following section explains the step - by- step process of Shipment Confirmation from WMS to ERP:
Integration – XxScmShipmentConfirmationWmsToErp
- postShipmentConfirmation : It uses Rest adapter to fetch the shipment confirmation related information from WMS.
- Global Assignment: The Global variable will be the Integration code which will be fetched from maintained lookup – “XX[Anonymized Customer]CommonLookup” with the reference of this lookup all other local variables will fetched which are given below.

---
**Table:**

| Variable name | Data type | Value |
| IntegrationCode | String | dvm:lookupValue('XX[Anonymized Customer]CommonLookup', 'IntegrationCode', ‘XXSCMSHIPMENTCONFIRMATIONWMSTOER’, 'IntegrationCode', '') IntegrationCode will be fetched from OIC lookup “XX[Anonymized Customer]CommonLookup”, with reference to this lookup all other local variables will be fetched. Value for IntegrationCode variable comes from Integration identifier. |

---

- Local Assignment:

---
**Table:**

| Variable name | Data type | Value |
| IntegrationID | String | dvm:lookupValue('XX[Anonymized Customer]CommonLookup', 'IntegrationCode', $IntegrationCode, 'RiceID', '')   “INT008” – Value is stored in OIC lookup “XX[Anonymized Customer]CommonLookup” and will be fetched based on the value of IntegrationCode variable from AssignGlobalVariables Source value. |
| ErrNotifyEmail | String | dvm:lookupValue('XX[Anonymized Customer]CommonLookup','IntegrationCode', $IntegrationCode, 'FailureNotify', '')  This value will be fetched from OIC lookup “XX[Anonymized Customer]CommonLookup” to send failure notification, in case integration fails due to any error. |
| SuccessNotifyEmail | String | dvm:lookupValue('XX[Anonymized Customer]CommonLookup','IntegrationCode', $IntegrationCode, 'SuccessNotify', '')  This value will be fetched from OIC lookup “XX[Anonymized Customer]CommonLookup” to send Success notification after normal process completion. |
| EmailFrom | String | dvm:lookupValue('Xx[Anonymized Customer]ConstantLookup', 'ID', 'FromEmailId', 'Value', '')  This value will be fetched from OIC lookup ““XX[Anonymized Customer]ConstantLookup” which is used to send notification email from OIC service. |
| checkEssJobStatus | String | NULL |

---

- Scope:
- Invoke Shipment Service : This is oracle ERP cloud adapter connection which will call the Shipment request service to create and confirm the shipment in ERP.
- Business Object – ShipmentService
- Operation – createAndConfirm
- Map Shipment Service: In the map activity, WMS Lgf Data fields are mapped with the ERP Shipment Service Request payload to create and confirm the shipment.
Note: WMS-ERP payload mapping will be as per the mapping document provided in “Sample Data & Mapping Template” section.
- Invoke PerformShippingTrxESSJob : This step will run the “Perform Shipping Transactions” ESS Job to confirm the Shipment in ERP by passing parameter as “ShipmentName” while running the ESS job.
- While : This step will run the ESS Job, following below condition till the Job run is completed -
- checkEssJobStatus not equal to SUCCEEDED
- checkEssJobStatus not equal to WARNING
- checkEssJobStatus not equal to ERROR
- Wait : ESS Job will wait for 10 sec to complete the run and once completed will proceed to next step.
- Invoke PerformShippingTrx : This step will invoke the ERP Integration Service to get the ESS Job Status based on ESS Job Result.
- Switch : This step will check the ESS Job Run Status result, if the ESS Job run completes with Status “Succeeded” it will create and confirm the Shipment in ERP and if fails with Status as “Warning or Error”, it will not create any Shipment.
- InvokeSuccessHandlerNotification :  Once the shipment is created and confirmed in Fusion and all the operations in Integration are completed normal then success email notification will be sent to respective team through “XxCommonNotificationHandler”.
With map activity, process will map the below values to common error handler Integration.

---
**Table:**

| Request Parameters | Values |
| IntegrationCode | $IntegrationCode |
| IntegrationID | $IntegationID |
| InstanceID | $self/nsmpr1:metadata/nsmpr1:runtime/nsmpr1:instanceId |
| ErrorCode | NULL |
| ErrMsg | NULL |
| EmailFrom | $EmailFrom |
| SuccessNotifyEmail | $SuccessNotifyEmail |
| EmailSub | concat("FYI",":","SUCCESS",":",$self/n